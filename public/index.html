<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>ì˜¬ìˆ˜ë¦¬ App ë‹¤ìš´ë¡œë“œ</title>
  <meta name="description" content="ë‚´ë¶€ í…ŒìŠ¤íŠ¸ìš© ì˜¬ìˆ˜ë¦¬ APK ë‹¤ìš´ë¡œë“œ í˜ì´ì§€" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“¦</text></svg>">
  <style>
    :root { --bg:#0b1020; --card:#121830; --text:#e8ecf1; --muted:#9fb1c5; --accent:#6ee7ff; }
    * { box-sizing: border-box; }
    html,body { margin:0; height:100%; background:var(--bg); color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Apple SD Gothic Neo, Helvetica, Arial, sans-serif; }
    .wrap { min-height:100%; display:flex; align-items:center; justify-content:center; padding:24px; }
    .card {
      width:100%; max-width:720px; background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border:1px solid rgba(255,255,255,0.08); border-radius:20px; padding:24px; box-shadow: 0 10px 40px rgba(0,0,0,0.35);
      backdrop-filter: blur(8px);
    }
    h1 { margin:0 0 8px; font-size: clamp(22px, 3.5vw, 30px); letter-spacing:.2px; }
    p.lead { margin:0 0 16px; color:var(--muted); }
    .meta { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin:16px 0 20px; }
    .meta div { background: var(--card); border:1px solid rgba(255,255,255,0.08); padding:12px 14px; border-radius:12px; font-size:14px; color:#d4deea; }
    .btns { display:flex; gap:12px; flex-wrap:wrap; }
    .btn {
      appearance:none; border:none; cursor:pointer; font-weight:600;
      padding:14px 18px; border-radius:12px; transition: transform .04s ease, box-shadow .2s ease, opacity .2s ease;
    }
    .btn-primary {
      background: linear-gradient(135deg, #22d3ee, #60a5fa);
      color:#04121a; box-shadow: 0 6px 18px rgba(96,165,250,.35);
    }
    .btn-secondary { background:#1b2447; color:#e8ecf1; border:1px solid rgba(255,255,255,.08); }
    .btn:active { transform: translateY(1px); }
    .note { margin-top:20px; font-size:14px; color:var(--muted); line-height:1.6; }
    .hr { height:1px; background:linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent); margin:20px 0; }
    .warn { background:#251b1b; border:1px solid rgba(255,120,120,.25); color:#ffd9d9; padding:12px 14px; border-radius:12px; font-size:14px; }
    code { background:#18213f; padding:2px 6px; border-radius:6px; }
    .qr-wrap { display:flex; align-items:center; gap:14px; margin-top:14px; flex-wrap:wrap; }
    canvas { background:#fff; border-radius:8px; }
    @media (max-width:560px){ .meta { grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <div class="wrap">
    <main class="card" role="main" aria-labelledby="title">
      <h1 id="title">ì˜¬ìˆ˜ë¦¬ ì•± ë‹¤ìš´ë¡œë“œ</h1>
      <p class="lead">ë‚´ë¶€ í…ŒìŠ¤íŠ¸ ë°°í¬ìš© ì•± íŒŒì¼ ì…ë‹ˆë‹¤. Android ê¸°ê¸°ì—ì„œ ì§ì ‘ ë‹¤ìš´ë¡œë“œí•´ ì„¤ì¹˜í•˜ì„¸ìš”.</p>

      <!-- ë©”íƒ€ ì •ë³´ -->
      <section class="meta" aria-label="ì•± ì •ë³´">
        <div><strong>ì•± ë²„ì „</strong><br><span id="appVersion">v1.2.0</span></div>
        <div><strong>íŒŒì¼ í¬ê¸°</strong><br><span id="fileSize">í™•ì¸ ì¤‘â€¦</span></div>
      </section>

      <!-- ë²„íŠ¼ -->
      <div class="btns">
        <!-- ì‹¤ì œ íŒŒì¼ëª…ìœ¼ë¡œ href ë°”ê¾¸ì„¸ìš” -->
        <a id="dlBtn" class="btn btn-primary" href="./myapp-v1.2.0.apk" download>ğŸ“¥ APK ë‹¤ìš´ë¡œë“œ</a>
        <button id="copyLinkBtn" class="btn btn-secondary" type="button">ğŸ”— ë§í¬ ë³µì‚¬</button>
      </div>

      <div class="hr"></div>

      <!-- QR ì„¤ì¹˜ ì•ˆë‚´ -->
      <section aria-label="QR ì½”ë“œë¡œ ì„¤ì¹˜">
        <h2 style="margin:0 0 8px; font-size:18px;">QR ì½”ë“œë¡œ ëª¨ë°”ì¼ì—ì„œ ì—´ê¸°</h2>
        <p class="note">ì•„ë˜ QRì„ ì¹´ë©”ë¼ë¡œ ìŠ¤ìº”í•˜ë©´ ì´ í˜ì´ì§€(ë˜ëŠ” APK)ë¥¼ íœ´ëŒ€í°ì—ì„œ ë°”ë¡œ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <div class="qr-wrap">
          <canvas id="qrPage" width="140" height="140" title="ì´ í˜ì´ì§€ QR"></canvas>
          <canvas id="qrApk" width="140" height="140" title="APK ì§ì ‘ ë‹¤ìš´ë¡œë“œ QR"></canvas>
        </div>
      </section>

      <div class="hr"></div>

      <!-- ì„¤ì¹˜ ìœ ì˜ì‚¬í•­ -->
      <section aria-label="ì„¤ì¹˜ ìœ ì˜ì‚¬í•­">
        <div class="warn">
          <strong>ì„¤ì¹˜ íŒ</strong><br/>
          â€¢ ë¸Œë¼ìš°ì €ê°€ ë³´ì•ˆ ê²½ê³ ë¥¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <em>ì¶œì²˜ë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” ì•± ì„¤ì¹˜</em>ë¥¼ ì¼ì‹œ í—ˆìš©í•´ì•¼ í•  ìˆ˜ ìˆì–´ìš”.<br/>
          â€¢ iPhoneì—ì„œëŠ” APKë¥¼ ì„¤ì¹˜í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Android ê¸°ê¸°ì—ì„œë§Œ ë™ì‘í•©ë‹ˆë‹¤.<br/>
          â€¢ ìƒˆ ë²„ì „ì„ ë°°í¬í•  ë•ŒëŠ” APK íŒŒì¼ì„ êµì²´í•˜ê³ , ìœ„ì˜ <code>ì•± ë²„ì „</code> í‘œì‹œë§Œ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.
        </div>
        <p class="note">ë¬¸ì œê°€ ìˆìœ¼ë©´ ê¸°ê¸°/ë¸Œë¼ìš°ì € ì¢…ë¥˜, ì˜¤ë¥˜ ë©”ì‹œì§€ ìŠ¤í¬ë¦°ìƒ·ê³¼ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.</p>
      </section>
    </main>
  </div>

  <script>
    // === ì„¤ì •: íŒŒì¼ëª…/ë²„ì „ë§Œ ë°”ê¿”ë„ ë™ì‘ ===
    const APK_FILE = 'allusuri-v1.0.0.apk';   // ì‹¤ì œ ì—…ë¡œë“œí•œ APK íŒŒì¼ëª…
    const APP_VERSION = 'v1.0.0';

    // í™”ë©´ í‘œì‹œ ì—…ë°ì´íŠ¸
    const dlBtn = document.getElementById('dlBtn');
    const appVersionEl = document.getElementById('appVersion');
    const fileSizeEl = document.getElementById('fileSize');
    appVersionEl.textContent = APP_VERSION;
    dlBtn.href = './' + APK_FILE;

    // íŒŒì¼ í¬ê¸°(HEAD) ì¡°íšŒ
    (async () => {
      try {
        const res = await fetch('./' + APK_FILE, { method: 'HEAD' });
        if (!res.ok) throw new Error('HEAD failed');
        const len = res.headers.get('content-length');
        if (len) {
          const size = humanFileSize(parseInt(len, 10));
          fileSizeEl.textContent = size;
        } else {
          fileSizeEl.textContent = 'ì•Œ ìˆ˜ ì—†ìŒ';
        }
      } catch (e) {
        fileSizeEl.textContent = 'í™•ì¸ ì‹¤íŒ¨';
      }
    })();

    function humanFileSize(bytes) {
      const thresh = 1024;
      if (Math.abs(bytes) < thresh) return bytes + ' B';
      const units = ['KB','MB','GB','TB'];
      let u = -1;
      do { bytes /= thresh; ++u; } while (Math.abs(bytes) >= thresh && u < units.length - 1);
      return bytes.toFixed(1) + ' ' + units[u];
    }

    // ë§í¬ ë³µì‚¬
    document.getElementById('copyLinkBtn').addEventListener('click', async () => {
      const apkUrl = new URL('./' + APK_FILE, location.href).toString();
      try {
        await navigator.clipboard.writeText(apkUrl);
        toast('ë‹¤ìš´ë¡œë“œ ë§í¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”!');
      } catch {
        prompt('ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:', apkUrl);
      }
    });

    // ê°„ë‹¨ í† ìŠ¤íŠ¸
    function toast(msg) {
      const el = document.createElement('div');
      el.textContent = msg;
      el.style.cssText = 'position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:#0e1a34;color:#e8ecf1;border:1px solid rgba(255,255,255,.12);padding:10px 14px;border-radius:10px;box-shadow:0 6px 20px rgba(0,0,0,.35);z-index:9999';
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 1600);
    }

    // ì•„ì£¼ ê°€ë²¼ìš´ QR ì½”ë“œ ë Œë”ëŸ¬(ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´)
    // ì°¸ê³ : ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ URL ê¸¸ì´ê°€ ê¸¸ì–´ë„ ë³´í†µ ë™ì‘í•©ë‹ˆë‹¤.
    // ë” ê²¬ê³ í•œ QRì´ í•„ìš”í•˜ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬(qrcode.js ë“±)ë¥¼ ì“°ì„¸ìš”.
    // ì•„ë˜ëŠ” Tiny-QR (ì•Œê³ ë¦¬ì¦˜ ë‹¨ìˆœ ë²„ì „)
    // ---- ì‹œì‘: ì´ˆì†Œí˜• QR (ver1-like, ì˜¤ë¥˜ë³´ì • ì—†ìŒ, ë°ëª¨ ìš©) ----
    function simpleHash(s){let h=0;for(let i=0;i<s.length;i++)h=(h*31 + s.charCodeAt(i))>>>0;return h;}
    function drawFakeQR(canvas, text){
      const ctx = canvas.getContext('2d');
      const N = 29; // ê²©ì ìˆ˜(ëŒ€ì¶©)
      const pad = 6; // ì—¬ë°±
      const size = Math.min(canvas.width, canvas.height);
      const cell = (size - pad*2)/N;
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,size,size);
      ctx.fillStyle = '#000';
      // ê°€ì¥ìë¦¬ ìœ„ì¹˜ íƒì§€ íŒ¨í„´ í‰ë‚´
      const finder = (x,y)=>{
        ctx.fillRect(pad+x*cell, pad+y*cell, cell*7, cell*7);
        ctx.fillStyle='#fff';ctx.fillRect(pad+(x+1)*cell, pad+(y+1)*cell, cell*5, cell*5);
        ctx.fillStyle='#000';ctx.fillRect(pad+(x+2)*cell, pad+(y+2)*cell, cell*3, cell*3);
        ctx.fillStyle='#000';
      };
      finder(0,0); finder(N-7,0); finder(0,N-7);

      let seed = simpleHash(text);
      // ëœë¤ íŒ¨í„´ì²˜ëŸ¼ ì°ê¸° (ë°ëª¨ìš©)
      for(let r=0;r<N;r++){
        for(let c=0;c<N;c++){
          const inFinder =
            (r<7&&c<7) || (r<7&&c>=N-7) || (r>=N-7&&c<7);
          if(inFinder) continue;
          // pseudo random
          seed = (seed * 1103515245 + 12345) & 0x7fffffff;
          if ((seed % 7) < 3) {
            ctx.fillRect(pad+c*cell, pad+r*cell, Math.ceil(cell), Math.ceil(cell));
          }
        }
      }
    }
    // ---- ë: ì´ˆì†Œí˜• QR ----

    // QR ê·¸ë¦¬ê¸° (í˜ì´ì§€ URL / APK URL)
    const pageUrl = location.href;
    const apkUrl = new URL('./' + APK_FILE, location.href).toString();
    drawFakeQR(document.getElementById('qrPage'), pageUrl);
    drawFakeQR(document.getElementById('qrApk'), apkUrl);
  </script>
</body>
</html>